{% extends 'base.html' %}
{% block title %} Trips {% endblock %}
{% block body %}
  
  <h2>Hi {{ user.fname }} !</h2> <br>

      <h3>Your Trips:</h3>
    
  <ul>
    {% for trip in trips %}
      {% if user.user_id == trip.user_id %}

      
      <li><a id='delete_{{ loop.index }}' href="/details/{{ trip.trip_name }}"> {{ trip.trip_name.title() }} </a>
        <button id='delete_{{ loop.index }}' class="btn btn-danger btn-xs" onClick="deleteTrip(this)"><i class="fas fa-trash"></i></button>
      </li><br>
      {% endif %}
    {% endfor %}
  </ul>
        </div>


  <form id="trips" method="get" action="/add-trips">
    <input type="text" name="trip" id="trip" placeholder="Trip Name" required>

    <input type="submit" id="trip" value="Add a trip">
  </form>

<script>
  "use strict"
  function confirmDelete(results) {
    document.location.reload()
  }

  function deleteTrip(param) {
    let delTrip = document.querySelector(`a#${param.id}`);
    console.log(delTrip.innerText);
    var confirmation = confirm("Are you sure you want to delete this trip?")
    if (confirmation) {
      let formInputs = {'trip_del': delTrip.innerText.trim()}
      $.post("/delete_trip", formInputs,confirmDelete);
    }
  }
</script>


{% endblock %}
